$(function(){var c,p,E,d=window.innerWidth,h=window.innerHeight,t=0,r=0,i=window.innerWidth/2,n=window.innerHeight/2;function f(){i=window.innerWidth/2,n=window.innerHeight/2,c.aspect=window.innerWidth/window.innerHeight,c.updateProjectionMatrix(),E.setSize(window.innerWidth,window.innerHeight)}function u(e){t=e.clientX-i,r=e.clientY-n}function m(e){1<e.touches.length&&(t=e.touches[0].pageX-i)}function v(e){1==e.touches.length&&(t=e.touches[0].pageX-i)}!function(){var e,t;(e=document.createElement("div")).style.position="fixed",e.style.top="0px",e.style.left="0px",e.style.zIndex="-1",e.style.opacity="0.5",document.body.appendChild(e),(c=new THREE.PerspectiveCamera(75,d/h,1,1e4)).position.z=1e3,p=new THREE.Scene,(E=new THREE.CanvasRenderer).setClearColor(16119801,0),E.setPixelRatio(window.devicePixelRatio),E.setSize(d,h),e.appendChild(E.domElement);for(var r=2*Math.PI,i=new THREE.SpriteCanvasMaterial({color:10263708,program:function(e){e.beginPath(),e.arc(0,0,.5,0,r,!0),e.fill()}}),n=0;n<1e3;n++)(t=new THREE.Sprite(i)).position.x=2*Math.random()-1,t.position.y=2*Math.random()-1,t.position.z=2*Math.random()-1,t.position.normalize(),t.position.multiplyScalar(10*Math.random()+450),t.scale.multiplyScalar(2),p.add(t);for(n=0;n<300;n++){var o=new THREE.Geometry,a=new THREE.Vector3(2*Math.random()-1,2*Math.random()-1,2*Math.random()-1);a.normalize(),a.multiplyScalar(450),o.vertices.push(a);var s=a.clone();s.multiplyScalar(.3*Math.random()+1),o.vertices.push(s);var l=new THREE.Line(o,new THREE.LineBasicMaterial({color:10263708,opacity:Math.random()}));p.add(l)}document.addEventListener("mousemove",u,!1),document.addEventListener("touchstart",m,!1),document.addEventListener("touchmove",v,!1),window.addEventListener("resize",f,!1)}(),function e(){requestAnimationFrame(e),c.position.x+=.05*(t-c.position.x),c.position.y+=.05*(200-r-c.position.y),c.lookAt(p.position),E.render(p,c)}()}),THREE.RenderableObject=function(){this.id=0,this.object=null,this.z=0,this.renderOrder=0},THREE.RenderableFace=function(){this.id=0,this.v1=new THREE.RenderableVertex,this.v2=new THREE.RenderableVertex,this.v3=new THREE.RenderableVertex,this.normalModel=new THREE.Vector3,this.vertexNormalsModel=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3],this.vertexNormalsLength=0,this.color=new THREE.Color,this.material=null,this.uvs=[new THREE.Vector2,new THREE.Vector2,new THREE.Vector2],this.z=0,this.renderOrder=0},THREE.RenderableVertex=function(){this.position=new THREE.Vector3,this.positionWorld=new THREE.Vector3,this.positionScreen=new THREE.Vector4,this.visible=!0},THREE.RenderableVertex.prototype.copy=function(e){this.positionWorld.copy(e.positionWorld),this.positionScreen.copy(e.positionScreen)},THREE.RenderableLine=function(){this.id=0,this.v1=new THREE.RenderableVertex,this.v2=new THREE.RenderableVertex,this.vertexColors=[new THREE.Color,new THREE.Color],this.material=null,this.z=0,this.renderOrder=0},THREE.RenderableSprite=function(){this.id=0,this.object=null,this.x=0,this.y=0,this.z=0,this.rotation=0,this.scale=new THREE.Vector2,this.material=null,this.renderOrder=0},THREE.Projector=function(){var ne,oe,n,ae,se,le,ce,pe,Ee,de,he,fe=[],ue=0,me=[],t=0,r=[],i=0,o=[],a=0,s=[],l=0,ve={objects:[],lights:[],elements:[]},Re=new THREE.Vector3,xe=new THREE.Vector4,u=new THREE.Box3(new THREE.Vector3(-1,-1,-1),new THREE.Vector3(1,1,1)),m=new THREE.Box3,v=new Array(3),ye=(new Array(4),new THREE.Matrix4),Te=new THREE.Matrix4,we=new THREE.Matrix4,He=new THREE.Matrix3,ge=new THREE.Frustum,Se=new THREE.Vector4,Me=new THREE.Vector4;this.projectVector=function(e,t){console.warn("THREE.Projector: .projectVector() is now vector.project()."),e.project(t)},this.unprojectVector=function(e,t){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject()."),e.unproject(t)},this.pickingRay=function(e,t){console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")};var Ce=new function(){var l=[],c=[],p=null,E=null,d=new THREE.Matrix3;function i(e){var t=e.position,r=e.positionWorld,i=e.positionScreen;r.copy(t).applyMatrix4(he),i.copy(r).applyMatrix4(Te);var n=1/i.w;i.x*=n,i.y*=n,i.z*=n,e.visible=-1<=i.x&&i.x<=1&&-1<=i.y&&i.y<=1&&-1<=i.z&&i.z<=1}function h(e,t,r){return!0===e.visible||!0===t.visible||!0===r.visible||(v[0]=e.positionScreen,v[1]=t.positionScreen,v[2]=r.positionScreen,u.intersectsBox(m.setFromPoints(v)))}function f(e,t,r){return(r.positionScreen.x-e.positionScreen.x)*(t.positionScreen.y-e.positionScreen.y)-(r.positionScreen.y-e.positionScreen.y)*(t.positionScreen.x-e.positionScreen.x)<0}return{setObject:function(e){E=(p=e).material,d.getNormalMatrix(p.matrixWorld),l.length=0,c.length=0},projectVertex:i,checkTriangleVisibility:h,checkBackfaceCulling:f,pushVertex:function(e,t,r){(n=be()).position.set(e,t,r),i(n)},pushNormal:function(e,t,r){l.push(e,t,r)},pushUv:function(e,t){c.push(e,t)},pushLine:function(e,t){var r=me[e],i=me[t];(ce=Ve()).id=p.id,ce.v1.copy(r),ce.v2.copy(i),ce.z=(r.positionScreen.z+i.positionScreen.z)/2,ce.renderOrder=p.renderOrder,ce.material=p.material,ve.elements.push(ce)},pushTriangle:function(e,t,r){var i=me[e],n=me[t],o=me[r];if(!1!==h(i,n,o)&&(E.side===THREE.DoubleSide||!0===f(i,n,o))){(se=ze()).id=p.id,se.v1.copy(i),se.v2.copy(n),se.v3.copy(o),se.z=(i.positionScreen.z+n.positionScreen.z+o.positionScreen.z)/3,se.renderOrder=p.renderOrder,se.normalModel.fromArray(l,3*e),se.normalModel.applyMatrix3(d).normalize();for(var a=0;a<3;a++){var s=se.vertexNormalsModel[a];s.fromArray(l,3*arguments[a]),s.applyMatrix3(d).normalize(),se.uvs[a].fromArray(c,2*arguments[a])}se.vertexNormalsLength=3,se.material=p.material,ve.elements.push(se)}}}};function be(){if(ae===t){var e=new THREE.RenderableVertex;return me.push(e),t++,ae++,e}return me[ae++]}function ze(){if(le===i){var e=new THREE.RenderableFace;return r.push(e),i++,le++,e}return r[le++]}function Ve(){if(pe===a){var e=new THREE.RenderableLine;return o.push(e),a++,pe++,e}return o[pe++]}function je(){if(de===l){var e=new THREE.RenderableSprite;return s.push(e),l++,de++,e}return s[de++]}function Le(e,t){return e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id!==t.id?e.id-t.id:0}this.projectScene=function(e,t,r,i){function n(e){(ne=function(){if(oe===ue){var e=new THREE.RenderableObject;return fe.push(e),ue++,oe++,e}return fe[oe++]}()).id=e.id,ne.object=e,Re.setFromMatrixPosition(e.matrixWorld),Re.applyMatrix4(Te),ne.z=Re.z,ne.renderOrder=e.renderOrder,ve.objects.push(ne)}de=pe=le=0,!(ve.elements.length=0)===e.autoUpdate&&e.updateMatrixWorld(),null===t.parent&&t.updateMatrixWorld(),ye.copy(t.matrixWorldInverse.getInverse(t.matrixWorld)),Te.multiplyMatrices(t.projectionMatrix,ye),ge.setFromMatrix(Te),oe=0,ve.objects.length=0,ve.lights.length=0,e.traverseVisible(function(e){if(e instanceof THREE.Light)ve.lights.push(e);else if(e instanceof THREE.Mesh||e instanceof THREE.Line){if(!1===e.material.visible)return;if(!0===e.frustumCulled&&!1===ge.intersectsObject(e))return;n(e)}else if(e instanceof THREE.Sprite){if(!1===e.material.visible)return;if(!0===e.frustumCulled&&!1===ge.intersectsSprite(e))return;n(e)}}),!0===r&&ve.objects.sort(Le);for(var o=0,a=ve.objects.length;o<a;o++){var s=ve.objects[o].object,l=s.geometry;if(Ce.setObject(s),he=s.matrixWorld,ae=0,s instanceof THREE.Mesh){if(l instanceof THREE.BufferGeometry){var c=l.attributes,p=l.groups;if(void 0===c.position)continue;for(var E=0,d=(J=c.position.array).length;E<d;E+=3)Ce.pushVertex(J[E],J[E+1],J[E+2]);if(void 0!==c.normal){var h=c.normal.array;for(E=0,d=h.length;E<d;E+=3)Ce.pushNormal(h[E],h[E+1],h[E+2])}if(void 0!==c.uv){var f=c.uv.array;for(E=0,d=f.length;E<d;E+=2)Ce.pushUv(f[E],f[E+1])}if(null!==l.index){var u=l.index.array;if(0<p.length)for(var m=0;m<p.length;m++){var v=p[m];for(E=v.start,d=v.start+v.count;E<d;E+=3)Ce.pushTriangle(u[E],u[E+1],u[E+2])}else for(E=0,d=u.length;E<d;E+=3)Ce.pushTriangle(u[E],u[E+1],u[E+2])}else for(E=0,d=J.length/3;E<d;E+=3)Ce.pushTriangle(E,E+1,E+2)}else if(l instanceof THREE.Geometry){var R=l.vertices,x=l.faces,y=l.faceVertexUvs[0];He.getNormalMatrix(he);for(var T=s.material,w=T instanceof THREE.MultiMaterial,H=!0===w?s.material:null,g=0,S=R.length;g<S;g++){var M=R[g];if(Re.copy(M),!0===T.morphTargets)for(var C=l.morphTargets,b=s.morphTargetInfluences,z=0,V=C.length;z<V;z++){var j=b[z];if(0!==j){var L=C[z].vertices[g];Re.x+=(L.x-M.x)*j,Re.y+=(L.y-M.y)*j,Re.z+=(L.z-M.z)*j}}Ce.pushVertex(Re.x,Re.y,Re.z)}for(var O=0,B=x.length;O<B;O++){var W=x[O];if(void 0!==(T=!0===w?H.materials[W.materialIndex]:s.material)){var P=T.side,k=me[W.a],N=me[W.b],F=me[W.c];if(!1!==Ce.checkTriangleVisibility(k,N,F)){var A=Ce.checkBackfaceCulling(k,N,F);if(P!==THREE.DoubleSide){if(P===THREE.FrontSide&&!1===A)continue;if(P===THREE.BackSide&&!0===A)continue}(se=ze()).id=s.id,se.v1.copy(k),se.v2.copy(N),se.v3.copy(F),se.normalModel.copy(W.normal),!1!==A||P!==THREE.BackSide&&P!==THREE.DoubleSide||se.normalModel.negate(),se.normalModel.applyMatrix3(He).normalize();for(var I=W.vertexNormals,D=0,G=Math.min(I.length,3);D<G;D++){var U=se.vertexNormalsModel[D];U.copy(I[D]),!1!==A||P!==THREE.BackSide&&P!==THREE.DoubleSide||U.negate(),U.applyMatrix3(He).normalize()}se.vertexNormalsLength=I.length;var q=y[O];if(void 0!==q)for(var X=0;X<3;X++)se.uvs[X].copy(q[X]);se.color=W.color,se.material=T,se.z=(k.positionScreen.z+N.positionScreen.z+F.positionScreen.z)/3,se.renderOrder=s.renderOrder,ve.elements.push(se)}}}}}else if(s instanceof THREE.Line){if(l instanceof THREE.BufferGeometry){if(void 0!==(c=l.attributes).position){var J;for(E=0,d=(J=c.position.array).length;E<d;E+=3)Ce.pushVertex(J[E],J[E+1],J[E+2]);if(null!==l.index)for(E=0,d=(u=l.index.array).length;E<d;E+=2)Ce.pushLine(u[E],u[E+1]);else{var Y=s instanceof THREE.LineSegments?2:1;for(E=0,d=J.length/3-1;E<d;E+=Y)Ce.pushLine(E,E+1)}}}else if(l instanceof THREE.Geometry){if(we.multiplyMatrices(Te,he),0===(R=s.geometry.vertices).length)continue;for((k=be()).positionScreen.copy(R[0]).applyMatrix4(we),Y=s instanceof THREE.LineSegments?2:1,g=1,S=R.length;g<S;g++)(k=be()).positionScreen.copy(R[g]).applyMatrix4(we),0<(g+1)%Y||(N=me[ae-2],Se.copy(k.positionScreen),Me.copy(N.positionScreen),!0==(Q=Me,_=Z=void 0,Z=0,_=1,ee=(K=Se).z+K.w,te=Q.z+Q.w,re=-K.z+K.w,ie=-Q.z+Q.w,0<=ee&&0<=te&&0<=re&&0<=ie||!(ee<0&&te<0||re<0&&ie<0)&&(ee<0?Z=Math.max(Z,ee/(ee-te)):te<0&&(_=Math.min(_,ee/(ee-te))),re<0?Z=Math.max(Z,re/(re-ie)):ie<0&&(_=Math.min(_,re/(re-ie))),!(_<Z||(K.lerp(Q,Z),Q.lerp(K,1-_),0))))&&(Se.multiplyScalar(1/Se.w),Me.multiplyScalar(1/Me.w),(ce=Ve()).id=s.id,ce.v1.positionScreen.copy(Se),ce.v2.positionScreen.copy(Me),ce.z=Math.max(Se.z,Me.z),ce.renderOrder=s.renderOrder,ce.material=s.material,s.material.vertexColors===THREE.VertexColors&&(ce.vertexColors[0].copy(s.geometry.colors[g]),ce.vertexColors[1].copy(s.geometry.colors[g-1])),ve.elements.push(ce)))}}else if(s instanceof THREE.Sprite){xe.set(he.elements[12],he.elements[13],he.elements[14],1),xe.applyMatrix4(Te);var $=1/xe.w;xe.z*=$,-1<=xe.z&&xe.z<=1&&((Ee=je()).id=s.id,Ee.x=xe.x*$,Ee.y=xe.y*$,Ee.z=xe.z,Ee.renderOrder=s.renderOrder,Ee.object=s,Ee.rotation=s.rotation,Ee.scale.x=s.scale.x*Math.abs(Ee.x-(xe.x+t.projectionMatrix.elements[0])/(xe.w+t.projectionMatrix.elements[12])),Ee.scale.y=s.scale.y*Math.abs(Ee.y-(xe.y+t.projectionMatrix.elements[5])/(xe.w+t.projectionMatrix.elements[13])),Ee.material=s.material,ve.elements.push(Ee))}}var K,Q,Z,_,ee,te,re,ie;return!0===i&&ve.elements.sort(Le),ve}},THREE.SpriteCanvasMaterial=function(e){THREE.Material.call(this),this.type="SpriteCanvasMaterial",this.color=new THREE.Color(16777215),this.program=function(e,t){},this.setValues(e)},THREE.SpriteCanvasMaterial.prototype=Object.create(THREE.Material.prototype),THREE.SpriteCanvasMaterial.prototype.constructor=THREE.SpriteCanvasMaterial,THREE.SpriteCanvasMaterial.prototype.clone=function(){var e=new THREE.SpriteCanvasMaterial;return e.copy(this),e.color.copy(this.color),e.program=this.program,e},THREE.CanvasRenderer=function(e){console.log("THREE.CanvasRenderer",THREE.REVISION),e=e||{};var T,w,H,g,S,M,C,b,z,V,j,L,O,B,W,P,k,N,F,A=this,I=new THREE.Projector,i=void 0!==e.canvas?e.canvas:document.createElement("canvas"),D=i.width,G=i.height,U=Math.floor(D/2),q=Math.floor(G/2),X=0,J=0,Y=D,$=G,n=1,K=i.getContext("2d",{alpha:!0===e.alpha}),r=new THREE.Color(0),o=!0===e.alpha?0:1,a=1,s=0,l=null,c=null,p=null,E=null,d=null,t=[],Q=(new THREE.RenderableVertex,new THREE.RenderableVertex,new THREE.Color),Z=(new THREE.Color,new THREE.Color,new THREE.Color,new THREE.Color,new THREE.Color),_=new THREE.Color,ee=new THREE.Color,te={},re=new THREE.Box2,ie=new THREE.Box2,ne=new THREE.Box2,oe=new THREE.Color,ae=new THREE.Color,se=new THREE.Color,le=new THREE.Vector3,ce=new THREE.Vector3,pe=new THREE.Vector3,Ee=new THREE.Matrix3;function de(e,t,r){xe(r.opacity),ye(r.blending);var i=t.scale.x*U,n=t.scale.y*q,o=.5*Math.sqrt(i*i+n*n);if(ne.min.set(e.x-o,e.y-o),ne.max.set(e.x+o,e.y+o),r instanceof THREE.SpriteMaterial){var a=r.map;if(null!==a){var s=te[a.id];if(void 0!==s&&s.version===a.version||(s=me(a),te[a.id]=s),void 0!==s.canvas){Te(s.canvas);var l=a.image,c=l.width*a.offset.x,p=l.height*a.offset.y,E=l.width*a.repeat.x,d=l.height*a.repeat.y,h=i/E,f=n/d;K.save(),K.translate(e.x,e.y),0!==r.rotation&&K.rotate(r.rotation),K.translate(-i/2,-n/2),K.scale(h,f),K.translate(-c,-p),K.fillRect(c,p,E,d),K.restore()}}else Te(r.color.getStyle()),K.save(),K.translate(e.x,e.y),0!==r.rotation&&K.rotate(r.rotation),K.scale(i,-n),K.fillRect(-.5,-.5,1,1),K.restore()}else r instanceof THREE.SpriteCanvasMaterial&&(m(r.color.getStyle()),Te(r.color.getStyle()),K.save(),K.translate(e.x,e.y),0!==r.rotation&&K.rotate(r.rotation),K.scale(i,n),r.program(K),K.restore())}function he(e,t,r,i){if(xe(i.opacity),ye(i.blending),K.beginPath(),K.moveTo(e.positionScreen.x,e.positionScreen.y),K.lineTo(t.positionScreen.x,t.positionScreen.y),i instanceof THREE.LineBasicMaterial){if(h(i.linewidth),f(i.linecap),u(i.linejoin),i.vertexColors!==THREE.VertexColors)m(i.color.getStyle());else{var n=r.vertexColors[0].getStyle(),o=r.vertexColors[1].getStyle();if(n===o)m(n);else{try{var a=K.createLinearGradient(e.positionScreen.x,e.positionScreen.y,t.positionScreen.x,t.positionScreen.y);a.addColorStop(0,n),a.addColorStop(1,o)}catch(e){a=n}m(a)}}K.stroke(),ne.expandByScalar(2*i.linewidth)}else i instanceof THREE.LineDashedMaterial&&(h(i.linewidth),f(i.linecap),u(i.linejoin),m(i.color.getStyle()),v([i.dashSize,i.gapSize]),K.stroke(),ne.expandByScalar(2*i.linewidth),v([]))}function fe(e,t,r,i){h(t),f(r),u(i),m(e.getStyle()),K.stroke(),ne.expandByScalar(2*t)}function ue(e){Te(e.getStyle()),K.fill()}function me(e){if(0===e.version||e instanceof THREE.CompressedTexture||e instanceof THREE.DataTexture)return{canvas:void 0,version:e.version};var t=e.image;if(!1===t.complete)return{canvas:void 0,version:0};var r=e.wrapS===THREE.RepeatWrapping||e.wrapS===THREE.MirroredRepeatWrapping,i=e.wrapT===THREE.RepeatWrapping||e.wrapT===THREE.MirroredRepeatWrapping,n=e.wrapS===THREE.MirroredRepeatWrapping,o=e.wrapT===THREE.MirroredRepeatWrapping,a=document.createElement("canvas");a.width=t.width*(n?2:1),a.height=t.height*(o?2:1);var s=a.getContext("2d");s.setTransform(1,0,0,-1,0,t.height),s.drawImage(t,0,0),!0===n&&(s.setTransform(-1,0,0,-1,t.width,t.height),s.drawImage(t,-t.width,0)),!0===o&&(s.setTransform(1,0,0,1,0,0),s.drawImage(t,0,t.height)),!0===n&&!0===o&&(s.setTransform(-1,0,0,1,t.width,0),s.drawImage(t,-t.width,t.height));var l="no-repeat";!0===r&&!0===i?l="repeat":!0===r?l="repeat-x":!0===i&&(l="repeat-y");var c=K.createPattern(a,l);return e.onUpdate&&e.onUpdate(e),{canvas:c,version:e.version}}function ve(e,t,r,i,n,o,a,s,l,c,p,E,d){var h=te[d.id];if(void 0!==h&&h.version===d.version||(h=me(d),te[d.id]=h),void 0===h.canvas)return Te("rgba( 0, 0, 0, 1)"),void K.fill();Te(h.canvas);var f,u,m,v,R,x,y,T,w=d.offset.x/d.repeat.x,H=d.offset.y/d.repeat.y,g=d.image.width*d.repeat.x,S=d.image.height*d.repeat.y;l=(l+w)*g,c=(c+H)*S,p=(p+w)*g,E=(E+H)*S,r-=e,i-=t,n-=e,o-=t,0!=(y=(l-=a=(a+w)*g)*(E-=s=(s+H)*S)-(p-=a)*(c-=s))&&(R=e-(f=(E*r-c*n)*(T=1/y))*a-(m=(l*n-p*r)*T)*s,x=t-(u=(E*i-c*o)*T)*a-(v=(l*o-p*i)*T)*s,K.save(),K.transform(f,u,m,v,R,x),K.fill(),K.restore())}function Re(e,t,r){var i,n=t.x-e.x,o=t.y-e.y,a=n*n+o*o;0!==a&&(n*=i=r/Math.sqrt(a),o*=i,t.x+=n,t.y+=o,e.x-=n,e.y-=o)}function xe(e){a!==e&&(K.globalAlpha=e,a=e)}function ye(e){s!==e&&(e===THREE.NormalBlending?K.globalCompositeOperation="source-over":e===THREE.AdditiveBlending?K.globalCompositeOperation="lighter":e===THREE.SubtractiveBlending?K.globalCompositeOperation="darker":e===THREE.MultiplyBlending&&(K.globalCompositeOperation="multiply"),s=e)}function h(e){p!==e&&(K.lineWidth=e,p=e)}function f(e){E!==e&&(K.lineCap=e,E=e)}function u(e){d!==e&&(K.lineJoin=e,d=e)}function m(e){l!==e&&(K.strokeStyle=e,l=e)}function Te(e){c!==e&&(K.fillStyle=e,c=e)}function v(e){t.length!==e.length&&(K.setLineDash(e),t=e)}void 0===K.setLineDash&&(K.setLineDash=function(){}),this.domElement=i,this.autoClear=!0,this.sortObjects=!0,this.sortElements=!0,this.info={render:{vertices:0,faces:0}},this.supportsVertexTextures=function(){},this.setFaceCulling=function(){},this.getContext=function(){return K},this.getContextAttributes=function(){return K.getContextAttributes()},this.getPixelRatio=function(){return n},this.setPixelRatio=function(e){void 0!==e&&(n=e)},this.setSize=function(e,t,r){D=e*n,G=t*n,i.width=D,i.height=G,U=Math.floor(D/2),q=Math.floor(G/2),!1!==r&&(i.style.width=e+"px",i.style.height=t+"px"),re.min.set(-U,-q),re.max.set(U,q),ie.min.set(-U,-q),ie.max.set(U,q),a=1,s=0,d=E=p=c=l=null,this.setViewport(0,0,e,t)},this.setViewport=function(e,t,r,i){X=e*n,J=t*n,Y=r*n,$=i*n},this.setScissor=function(){},this.setScissorTest=function(){},this.setClearColor=function(e,t){r.set(e),o=void 0!==t?t:1,ie.min.set(-U,-q),ie.max.set(U,q)},this.setClearColorHex=function(e,t){console.warn("THREE.CanvasRenderer: .setClearColorHex() is being removed. Use .setClearColor() instead."),this.setClearColor(e,t)},this.getClearColor=function(){return r},this.getClearAlpha=function(){return o},this.getMaxAnisotropy=function(){return 0},this.clear=function(){!1===ie.isEmpty()&&(ie.intersect(re),ie.expandByScalar(2),ie.min.x=ie.min.x+U,ie.min.y=-ie.min.y+q,ie.max.x=ie.max.x+U,ie.max.y=-ie.max.y+q,o<1&&K.clearRect(0|ie.min.x,0|ie.max.y,ie.max.x-ie.min.x|0,ie.min.y-ie.max.y|0),0<o&&(ye(THREE.NormalBlending),xe(1),Te("rgba("+Math.floor(255*r.r)+","+Math.floor(255*r.g)+","+Math.floor(255*r.b)+","+o+")"),K.fillRect(0|ie.min.x,0|ie.max.y,ie.max.x-ie.min.x|0,ie.min.y-ie.max.y|0)),ie.makeEmpty())},this.clearColor=function(){},this.clearDepth=function(){},this.clearStencil=function(){},this.render=function(e,t){if(t instanceof THREE.Camera!=0){var r=e.background;r&&r.isColor?(Te("rgb("+Math.floor(255*r.r)+","+Math.floor(255*r.g)+","+Math.floor(255*r.b)+")"),K.fillRect(0,0,D,G)):!0===this.autoClear&&this.clear(),A.info.render.vertices=0,A.info.render.faces=0,K.setTransform(Y/D,0,0,-$/G,X,G-J),K.translate(U,q),T=I.projectScene(e,t,this.sortObjects,this.sortElements),w=T.elements,H=T.lights,Ee.getNormalMatrix(t.matrixWorldInverse),function(){oe.setRGB(0,0,0),ae.setRGB(0,0,0),se.setRGB(0,0,0);for(var e=0,t=H.length;e<t;e++){var r=H[e],i=r.color;r instanceof THREE.AmbientLight?oe.add(i):r instanceof THREE.DirectionalLight?ae.add(i):r instanceof THREE.PointLight&&se.add(i)}}();for(var i=0,n=w.length;i<n;i++){var o=w[i],a=o.material;if(void 0!==a&&0!==a.opacity){if(ne.makeEmpty(),o instanceof THREE.RenderableSprite)(g=o).x*=U,g.y*=q,de(g,o,a);else if(o instanceof THREE.RenderableLine)g=o.v1,S=o.v2,g.positionScreen.x*=U,g.positionScreen.y*=q,S.positionScreen.x*=U,S.positionScreen.y*=q,ne.setFromPoints([g.positionScreen,S.positionScreen]),!0===re.intersectsBox(ne)&&he(g,S,o,a);else if(o instanceof THREE.RenderableFace){if(g=o.v1,S=o.v2,M=o.v3,g.positionScreen.z<-1||1<g.positionScreen.z)continue;if(S.positionScreen.z<-1||1<S.positionScreen.z)continue;if(M.positionScreen.z<-1||1<M.positionScreen.z)continue;g.positionScreen.x*=U,g.positionScreen.y*=q,S.positionScreen.x*=U,S.positionScreen.y*=q,M.positionScreen.x*=U,M.positionScreen.y*=q,0<a.overdraw&&(Re(g.positionScreen,S.positionScreen,a.overdraw),Re(S.positionScreen,M.positionScreen,a.overdraw),Re(M.positionScreen,g.positionScreen,a.overdraw)),ne.setFromPoints([g.positionScreen,S.positionScreen,M.positionScreen]),!0===re.intersectsBox(ne)&&(s=g,l=S,c=M,E=1,d=2,h=o,f=a,y=x=R=v=m=u=void(p=0),A.info.render.vertices+=3,A.info.render.faces++,xe(f.opacity),ye(f.blending),C=s.positionScreen.x,b=s.positionScreen.y,z=l.positionScreen.x,V=l.positionScreen.y,j=c.positionScreen.x,L=c.positionScreen.y,u=C,m=b,v=z,R=V,x=j,y=L,K.beginPath(),K.moveTo(u,m),K.lineTo(v,R),K.lineTo(x,y),K.closePath(),(f instanceof THREE.MeshLambertMaterial||f instanceof THREE.MeshPhongMaterial)&&null===f.map?(Z.copy(f.color),_.copy(f.emissive),f.vertexColors===THREE.FaceColors&&Z.multiply(h.color),Q.copy(oe),ce.copy(s.positionWorld).add(l.positionWorld).add(c.positionWorld).divideScalar(3),function(e,t,r){for(var i=0,n=H.length;i<n;i++){var o=H[i];if(ee.copy(o.color),o instanceof THREE.DirectionalLight){var a=le.setFromMatrixPosition(o.matrixWorld).normalize();if((s=t.dot(a))<=0)continue;s*=o.intensity,r.add(ee.multiplyScalar(s))}else if(o instanceof THREE.PointLight){var s;if(a=le.setFromMatrixPosition(o.matrixWorld),(s=t.dot(le.subVectors(a,e).normalize()))<=0)continue;if(0==(s*=0==o.distance?1:1-Math.min(e.distanceTo(a)/o.distance,1)))continue;s*=o.intensity,r.add(ee.multiplyScalar(s))}}}(ce,h.normalModel,Q),Q.multiply(Z).add(_),!0===f.wireframe?fe(Q,f.wireframeLinewidth,f.wireframeLinecap,f.wireframeLinejoin):ue(Q)):f instanceof THREE.MeshBasicMaterial||f instanceof THREE.MeshLambertMaterial||f instanceof THREE.MeshPhongMaterial?null!==f.map?f.map.mapping===THREE.UVMapping&&(O=h.uvs,ve(C,b,z,V,j,L,O[p].x,O[p].y,O[E].x,O[E].y,O[d].x,O[d].y,f.map)):null!==f.envMap?f.envMap.mapping===THREE.SphericalReflectionMapping&&(pe.copy(h.vertexNormalsModel[p]).applyMatrix3(Ee),B=.5*pe.x+.5,W=.5*pe.y+.5,pe.copy(h.vertexNormalsModel[E]).applyMatrix3(Ee),P=.5*pe.x+.5,k=.5*pe.y+.5,pe.copy(h.vertexNormalsModel[d]).applyMatrix3(Ee),N=.5*pe.x+.5,F=.5*pe.y+.5,ve(C,b,z,V,j,L,B,W,P,k,N,F,f.envMap)):(Q.copy(f.color),f.vertexColors===THREE.FaceColors&&Q.multiply(h.color),!0===f.wireframe?fe(Q,f.wireframeLinewidth,f.wireframeLinecap,f.wireframeLinejoin):ue(Q)):(f instanceof THREE.MeshNormalMaterial?(pe.copy(h.normalModel).applyMatrix3(Ee),Q.setRGB(pe.x,pe.y,pe.z).multiplyScalar(.5).addScalar(.5)):Q.setRGB(1,1,1),!0===f.wireframe?fe(Q,f.wireframeLinewidth,f.wireframeLinecap,f.wireframeLinejoin):ue(Q)))}ie.union(ne)}}K.setTransform(1,0,0,1,0,0)}else console.error("THREE.CanvasRenderer.render: camera is not an instance of THREE.Camera.");var s,l,c,p,E,d,h,f,u,m,v,R,x,y}};